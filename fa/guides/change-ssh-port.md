---
title: تغییر پورت پیش‌فرض SSH  
description: بیاموزید چگونه با تغییر پورت پیش‌فرض SSH از 22 به یک پورت دلخواه، امنیت سرور خود را افزایش دهید.
---

# تغییر پورت SSH در اوبونتو

## مقدمه

SSH برای دسترسی ایمن به سیستم‌ها از راه دور استفاده می‌شود. به طور پیش‌فرض، SSH روی پورت 22 تنظیم شده است. تغییر این پورت می‌تواند از حملات خودکار جلوگیری کرده و امنیت سرور شما را تقویت کند. در این راهنما مراحل تغییر پورت SSH در اوبونتو به شما آموزش داده می‌شود.

::: tip نکته
تغییر پورت SSH یکی از اقدامات متداول امنیتی است، اما جایگزینی برای دیگر روش‌های امنیتی مانند رمزهای قوی یا ssh key نمی‌باشد.
:::

## مراحل تغییر پورت SSH

1. فایل تنظیمات SSH را باز کنید:

```bash
sudo nano /etc/ssh/sshd_config
```

2. خط `#Port 22` را پیدا کنید و آن را به پورت دلخواه خود (مثلاً 2222) تغییر دهید:

```
Port 2222
```

3. فایل را ذخیره کرده و خارج شوید.

4. سرویس SSH را مجدداً راه‌اندازی کنید:

```bash
sudo service ssh restart
```

## اوبونتو 23.04 و نسخه‌های بالاتر

در اوبونتو 23.04 و نسخه‌های بعدی، تنظیمات SSH به شکل متفاوتی مدیریت می‌شود:

1. فایل تنظیمات سوکت SSH را ویرایش کنید:

```bash
sudo nano /lib/systemd/system/ssh.socket
```

2. تنظیمات `ListenStream` را به پورت دلخواه خود (مثلاً 2222) تغییر دهید:

```
[Socket]
ListenStream=2222
Accept=no
```

3. فایل را ذخیره کرده و خارج شوید (در ویرایشگر nano ابتدا Ctrl+X، سپس Y و  در اخر Enter).

4. سرویس SSH را مجدداً راه‌اندازی کنید:

```bash
sudo systemctl daemon-reload
sudo systemctl restart ssh.service
```

## احتیاط‌های ایمنی و تنظیم فایروال

::: warning هشدار
هنگام اعمال این تغییرات همیشه ترمینال SSH فعلی خود را باز نگه دارید. قبل از بستن ترمینال اصلی، با یک ترمینال جدید تنظیمات را آزمایش کنید.
:::

اگر از UFW استفاده می‌کنید:

1. پورت جدید SSH را باز کنید:

```bash
sudo ufw allow 2222/tcp
```

2. قانون پورت قدیمی SSH را حذف کنید:

```bash
sudo ufw delete allow 22/tcp
```

3. UFW را مجدداً بارگذاری کنید:

```bash
sudo ufw reload
```

## آزمایش پورت جدید SSH

تنظیمات جدید را با باز کردن یک اتصال SSH جدید آزمایش کنید:

```bash
ssh -p 2222 username@your_server_ip
```

اگر موفقیت‌آمیز بود، می‌توانید ترمینال SSH قدیمی خود را ببندید.

## رفع اشکال

در صورت مواجهه با مشکل:

1. بررسی کنید که سرویس SSH در حال اجرا است:

```bash
sudo systemctl status ssh
```

2. اطمینان حاصل کنید که پورت جدید در حال گوش دادن است:

```bash
sudo ss -tlnp | grep ssh
```

3. بررسی کنید که فایروال به درستی تنظیم شده است:

```bash
sudo ufw status
```

::: danger اخطار
در صورت از دست دادن دسترسی، ممکن است نیاز به استفاده از دسترسی کنسول سرور برای بازگرداندن تغییرات یا رفع اشکال بیشتر داشته باشید.
:::
